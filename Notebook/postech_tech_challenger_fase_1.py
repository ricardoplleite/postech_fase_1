# -*- coding: utf-8 -*-
"""postech - tech chalenger - Fase 1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eBSZd2TtdBATLqbVkpr5G6rzgDsGt224

# **POSTECH - Data Analytics - Fase 1**

Imagine que os diretores de uma empresa de vinhos no Brasil solicitaram
para voc√™, expert na √°rea de data analytics, uma demanda de an√°lise de dados
e levantamentos de insights para trazer algumas respostas sobre alguns
questionamentos internos na empresa, tal como:

*   Qual √© o pa√≠s com maior exporta√ß√£o dos produtos de vinhos de mesa, espumantes e sucos de uva longo todo o per√≠odo?

*   Qual √© o pa√≠s com maior importa√ß√£o dos produtos de vinhos de mesa,
espumantes e sucos de uva longo todo o per√≠odo?

*   Como √© a tend√™ncia da exporta√ß√£o ao longo dos anos para cada um
dos produtos (vinhos de mesa, espumantes e sucos de uva)?

*   Como √© a tend√™ncia da importa√ß√£o ao longo dos anos para cada um
dos produtos (vinhos de mesa, espumantes e sucos de uva)?

*   Como √© o cen√°rio de produ√ß√£o de vinhos, sucos e derivados no Brasil?

*   Quais s√£o as caracter√≠sticas do clima favor√°vel para a produ√ß√£o de
vinhos, sucos e derivados?

*   E qual √© o valor de exporta√ß√£o dos produtos de vinhos de mesa,
espumantes e sucos de uva para o ano mais recente da base?

Voc√™ deve trazer a resposta para os dados em um formato de relat√≥rio,
consolidando as an√°lises gr√°ficas com storytelling, contando uma hist√≥ria com
os dados para que os diretores possam receber esses insights da melhor forma
poss√≠vel.

**Base de dados a ser utilizada para a an√°lise:**

http://vitibrasil.cnpuv.embrapa.br/index.php?opcao=opt_01


**A entrega:**

A entrega deve ser uma apresenta√ß√£o com o storytelling e an√°lises +
c√≥digo Python demonstrando toda a cria√ß√£o dos gr√°ficos

Carregando Bases de dados.
"""

import pandas as pd

"""Coleta de dados para informa√ß√µes sobre exporta√ß√£o de vinhos"""

# Caminho para o arquivo
expVinho = pd.read_csv("/content/ExpVinho.csv", encoding='utf-8', sep='\t')
expEspumante = pd.read_csv("/content/ExpEspumantes.csv", encoding='utf-8', sep='\t')
expSuco = pd.read_csv("/content/ExpSuco.csv", encoding='utf-8', sep='\t')
expUva = pd.read_csv("/content/ExpUva.csv", encoding='utf-8', sep='\t')

# Adiciona uma nova coluna para identificar a origem
expVinho['Origem'] = 'Vinho'
expEspumante['Origem'] = 'Espumante'
expSuco['Origem'] = 'Suco'
expUva['Origem'] = 'Uva'

# Concatena os DataFrames
df_exp = pd.concat([expVinho, expEspumante, expSuco, expUva], ignore_index=True)

# Exibe o resultado
df_exp.head(10)

expVinho.head()

"""Coleta de dados para informa√ß√µes sobre importa√ß√£o de vinhos"""

# Caminho para o arquivo
impVinhos = pd.read_csv("/content/ImpVinhos.csv", encoding='utf-8', sep='\t')
impEspumante = pd.read_csv("/content/ImpEspumantes.csv", encoding='utf-8', sep='\t')
impUva = pd.read_csv("/content/ImpFrescas.csv", encoding='utf-8', sep='\t')
impSuco = pd.read_csv("/content/ImpSuco.csv", encoding='utf-8', sep='\t')

# Adiciona uma nova coluna para identificar a origem
impVinhos['Origem'] = 'Vinho'
impEspumante['Origem'] = 'Espumante'
impUva['Origem'] = 'Suco'
impSuco['Origem'] = 'Uva'

# Concatena os DataFrames
df_imp = pd.concat([impVinhos, impEspumante, impSuco, impUva], ignore_index=True)

# Exibe o resultado
df_imp.head(10)

"""Coletando informa√ß√µes sobre a produ√ß√£o de vinho para Rio Grande do Sul"""

# Caminho para o arquivo
df = pd.read_csv("/content/Producao.csv",
                    encoding="ISO-8859-1",
                    sep=";",
                    thousands=".",
                    decimal=",",
                    engine='python')

# Filtrando as linhas com os produtos desejados
produtos_desejados = [
    "VINHO DE MESA",
    "VINHO FINO DE MESA (VINIFERA)",
    "SUCO",
    "DERIVADOS"
]

prodVinho = df[df["produto"].str.upper().isin(produtos_desejados)]

prodVinho.head()



"""## Qual √© o pa√≠s com maior exporta√ß√£o dos produtos de vinhos de mesa, espumantes e sucos de uva longo todo o per√≠odo?"""

# Selecionar colunas de volume (sem sufixo .1) e incluir 'Pa√≠s' e 'Origem'
colunas_volume = [col for col in df_exp.columns if col.isnumeric()]
colunas_utilizadas = ['Pa√≠s', 'Origem'] + colunas_volume

# Filtrar o DataFrame
df_volume = df_exp[colunas_utilizadas]

# Somar o volume total por pa√≠s
df_volume['Total_Exportado_Litros'] = df_volume[colunas_volume].sum(axis=1)
df_exportacao_total_por_pais = df_volume.groupby('Pa√≠s')['Total_Exportado_Litros'].sum().sort_values(ascending=False)

# Obter o pa√≠s com maior volume exportado
pais_top_exportador = df_exportacao_total_por_pais.idxmax()
volume_top_exportador = df_exportacao_total_por_pais.max()

pais_top_exportador, volume_top_exportador

"""**Pa√≠ses Baixos:**

Volume total exportado: 613.465.576 Litros
"""

import matplotlib.pyplot as plt

# Selecionar os 10 pa√≠ses com maior volume exportado
top_10_paises = df_exportacao_total_por_pais.head(10)

# Criar o gr√°fico
plt.figure(figsize=(12, 6))
bars = plt.bar(top_10_paises.index, top_10_paises.values, color='skyblue')
plt.title('Top 10 Pa√≠ses com Maior Volume de Exporta√ß√£o\n(Vinhos de Mesa, Espumantes e Sucos de Uva)', fontsize=14)
plt.ylabel('Volume Total Exportado (Litros)', fontsize=12)
plt.xlabel('Pa√≠s', fontsize=12)
plt.xticks(rotation=45)
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Adicionar r√≥tulos de valor em cima de cada barra
for bar in bars:
    yval = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2, yval + 1e6, f'{int(yval):,}',
             ha='center', va='bottom', fontsize=10)

plt.tight_layout()
plt.show()

"""An√°lise Justificativa das Exporta√ß√µes

Os **Pa√≠ses Baixos** lideram o ranking de exporta√ß√µes com mais de 613 milh√µes de litros, o que pode ser atribu√≠do √† sua posi√ß√£o estrat√©gica como hub log√≠stico na Europa. Roterd√£, um dos maiores portos do mundo, facilita a redistribui√ß√£o de produtos para outros pa√≠ses europeus. Al√©m disso, o alto poder aquisitivo e h√°bitos alimentares diversificados favorecem o consumo de bebidas importadas, como vinhos e sucos tropicais.

Os **Estados Unidos**, na segunda posi√ß√£o, s√£o um dos maiores mercados consumidores do mundo, com forte cultura de consumo de vinhos e derivados. A grande popula√ß√£o, associada √† diversidade √©tnica e gastron√¥mica, contribui para a demanda por produtos brasileiros. Al√©m disso, acordos comerciais e facilidade log√≠stica a√©rea e mar√≠tima fortalecem essa rela√ß√£o.

O **Reino Unido** aparece em terceiro lugar com volume expressivo. A cultura tradicional de consumo de vinho, somada ao fato de n√£o possuir clima favor√°vel √† produ√ß√£o em grande escala, torna o pa√≠s dependente de importa√ß√µes. O Brasil se beneficia por ser um fornecedor alternativo ao tradicional eixo europeu.

**Paraguai e Jap√£o** ocupam posi√ß√µes de destaque por raz√µes distintas. O Paraguai, al√©m da proximidade geogr√°fica, possui acordos de com√©rcio e circula√ß√£o regional mais flex√≠veis, enquanto o Jap√£o valoriza produtos naturais e tropicais, sendo grande importador de suco de uva brasileiro, principalmente pela percep√ß√£o de qualidade dos produtos da Serra Ga√∫cha.

**Argentina e R√∫ssia** representam mercados estrat√©gicos. A Argentina, apesar de tamb√©m ser produtora, pode adquirir produtos espec√≠ficos n√£o produzidos localmente. J√° a R√∫ssia, com clima severo e produ√ß√£o limitada, depende amplamente de importa√ß√µes, principalmente de sucos e vinhos tropicais.

**Alemanha, Canad√° e Espanha** completam o ranking. A Alemanha e o Canad√° possuem consumo elevado de sucos e produtos naturais. J√° a Espanha, embora seja grande produtora de vinhos, pode importar para suprir nichos espec√≠ficos de mercado, como sucos ou blends tropicais.

## Qual √© o pa√≠s com maior importa√ß√£o dos produtos de vinhos de mesa, espumantes e sucos de uva longo todo o per√≠odo?
"""

# Selecionar colunas de volume (anos) e calcular total importado por pa√≠s
colunas_volume_imp = [col for col in df_imp.columns if col.isnumeric()]
df_imp['Total_Importado_Litros'] = df_imp[colunas_volume_imp].sum(axis=1)

# Agrupar por pa√≠s e somar o total
df_importacao_por_pais = df_imp.groupby('Pa√≠s')['Total_Importado_Litros'].sum().sort_values(ascending=False)

# Obter pa√≠s com maior volume importado
pais_top_importador = df_importacao_por_pais.idxmax()
volume_top_importador = df_importacao_por_pais.max()

pais_top_importador, volume_top_importador

"""**üá®üá± Chile**

Volume total importado: 1.371.739.444 Litros

O Chile se destaca por ser um dos maiores produtores mundiais de vinho, com proximidade geogr√°fica, acordos comerciais favor√°veis (como o Mercosul), e tradi√ß√£o consolidada no setor vin√≠cola, o que facilita o fornecimento cont√≠nuo e competitivo.
"""

import matplotlib.pyplot as plt

# Selecionar os 10 pa√≠ses com maior volume importado
top_10_importacoes = df_importacao_por_pais.head(10)

# Criar o gr√°fico
plt.figure(figsize=(12, 6))
bars = plt.bar(top_10_importacoes.index, top_10_importacoes.values, color='lightgreen')
plt.title('Top 10 Pa√≠ses que mais Exportaram', fontsize=14)
plt.ylabel('Volume Total Importado (Litros)', fontsize=12)
plt.xlabel('Pa√≠s', fontsize=12)
plt.xticks(rotation=45)
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Adicionar r√≥tulos de valor em cima de cada barra
for bar in bars:
    yval = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2, yval + 1e6, f'{int(yval):,}',
             ha='center', va='bottom', fontsize=10)

plt.tight_layout()
plt.show()

"""**An√°lise Justificativa das Exporta√ß√µes Mundiais de Vinhos de Mesa, Espumantes e Sucos de Uva**

O gr√°fico evidencia o papel dominante do **Chile** no cen√°rio global, com mais de 1,37 bilh√£o de litros exportados, consolidando sua posi√ß√£o como o principal fornecedor internacional desses produtos. Este volume expressivo √© resultado de uma pol√≠tica agroindustrial estruturada, investimentos cont√≠nuos em tecnologia de vinifica√ß√£o e clima ideal para cultivo de uvas, especialmente no Vale Central, com grande amplitude t√©rmica e baixa incid√™ncia de pragas.

Na sequ√™ncia, **Argentina e Portugal** tamb√©m figuram como grandes exportadores, com 570 milh√µes e 366 milh√µes de litros, respectivamente. A Argentina se destaca por sua produ√ß√£o em escala no terroir de Mendoza e por sua capacidade log√≠stica na exporta√ß√£o para Am√©rica Latina, Am√©rica do Norte e Europa. Portugal, por sua vez, se apoia na tradi√ß√£o secular de vinhos como o do Porto e na excel√™ncia em vinhos verdes, atraindo mercados exigentes da Europa e √Åsia.

**It√°lia**, com mais de 300 milh√µes de litros, e **Fran√ßa** com 152 milh√µes, mant√™m sua posi√ß√£o como √≠cones da vinicultura mundial. Esses pa√≠ses combinam tradi√ß√£o, qualidade e forte atua√ß√£o em mercados premium, abastecendo desde grandes redes de varejo at√© o segmento de luxo. A presen√ßa expressiva da Espanha e Alemanha no ranking tamb√©m reflete seu papel como fornecedores relevantes tanto de vinhos quanto de derivados de uva e espumantes.

**Uruguai, Estados Unidos e Peru** fecham a lista, mostrando inser√ß√£o em nichos espec√≠ficos. O Uruguai se destaca pela produ√ß√£o da uva Tannat, enquanto os Estados Unidos equilibram exporta√ß√µes de suco de uva concentrado e vinhos para mercados secund√°rios. O Peru, em expans√£o na vitivinicultura, mostra avan√ßo gra√ßas a incentivos fiscais e aumento da produ√ß√£o voltada √† exporta√ß√£o.

Essa distribui√ß√£o revela como fatores como clima favor√°vel, acordos comerciais, infraestrutura portu√°ria e diversifica√ß√£o de produtos influenciam diretamente a competitividade e a presen√ßa internacional desses pa√≠ses no setor.

## Como √© a tend√™ncia da exporta√ß√£o ao longo dos anos para cada um dos produtos (vinhos de mesa, espumantes e sucos de uva)?
"""

# Agrupar os dados de exporta√ß√£o por ano e por tipo de produto (Origem)
# Primeiro vamos somar os volumes por ano e produto
df_exportacao_anos = df_exp.groupby('Origem')[colunas_volume].sum().T

# Ajustar o √≠ndice para tipo num√©rico (anos)
df_exportacao_anos.index = df_exportacao_anos.index.astype(int)

# Plotar a tend√™ncia ao longo dos anos
import matplotlib.pyplot as plt

plt.figure(figsize=(14, 7))
for produto in df_exportacao_anos.columns:
    plt.plot(df_exportacao_anos.index, df_exportacao_anos[produto], label=produto)

plt.title('Tend√™ncia da Exporta√ß√£o ao Longo dos Anos por Produto')
plt.xlabel('Ano')
plt.ylabel('Volume Exportado (Litros)')
plt.legend(title='Produto')
plt.grid(True, linestyle='--', alpha=0.7)
plt.tight_layout()
plt.show()

"""Tend√™ncia da Exporta√ß√£o por Produto ao Longo dos Anos

Vinho de Mesa:

Apresenta a curva mais vol√°til entre os produtos, com altos picos de exporta√ß√£o em determinados anos, especialmente por volta de 1993 e 2009, quando ultrapassou os 20 milh√µes de litros exportados. Esses picos podem estar relacionados a a√ß√µes pontuais de com√©rcio exterior ou incentivos fiscais. Apesar das oscila√ß√µes, o vinho mant√©m uma presen√ßa relevante e est√°vel na pauta exportadora ao longo dos anos.

Suco de Uva:

Exibe uma trajet√≥ria mais constante, com crescimento significativo entre os anos 1985 e 2000, seguido de uma leve oscila√ß√£o. A partir de 2018, observa-se uma retomada do crescimento, indicando aumento na demanda global por produtos naturais e saud√°veis, como o suco integral de uva. Esse produto √© impulsionado por sua apresenta√ß√£o n√£o alco√≥lica, o que o torna atrativo em mercados diversificados, inclusive infantis e religiosos.

Espumante:

Com volumes historicamente mais baixos em compara√ß√£o aos outros produtos, o espumante mostra uma tend√™ncia de crescimento gradual, sobretudo a partir de 2010. O aumento da visibilidade internacional dos espumantes brasileiros, especialmente da Serra Ga√∫cha, e a participa√ß√£o em feiras internacionais contribu√≠ram para esse avan√ßo, ainda que em menor escala de volume.

| Produto   | Tend√™ncia Geral         | Destaques               |
| --------- | ----------------------- | ----------------------- |
| Vinho     | Vol√°til com picos altos | Picos em 1993 e 2009    |
| Suco      | Est√°vel e crescente     | Retomada forte p√≥s-2018 |
| Espumante | Crescimento moderado    | Alta ap√≥s 2010          |

## Como √© a tend√™ncia da importa√ß√£o ao longo dos anos para cada um dos produtos (vinhos de mesa, espumantes e sucos de uva)?
"""

# Agrupar os dados de importa√ß√£o por ano e tipo de produto (Origem)
df_importacao_anos = df_imp.groupby('Origem')[colunas_volume_imp].sum().T

# Ajustar o √≠ndice para tipo num√©rico (anos)
df_importacao_anos.index = df_importacao_anos.index.astype(int)

# Plotar a tend√™ncia ao longo dos anos
plt.figure(figsize=(14, 7))
for produto in df_importacao_anos.columns:
    plt.plot(df_importacao_anos.index, df_importacao_anos[produto], label=produto)

plt.title('Tend√™ncia da Importa√ß√£o ao Longo dos Anos por Produto')
plt.xlabel('Ano')
plt.ylabel('Volume Importado (Litros)')
plt.legend(title='Produto')
plt.grid(True, linestyle='--', alpha=0.7)
plt.tight_layout()
plt.show()

"""Tend√™ncia da Importa√ß√£o por Produto ao Longo dos Anos
Vinho de Mesa:

Apresenta a curva mais expressiva entre os tr√™s produtos. Desde os anos 2000, observa-se uma tend√™ncia de crescimento cont√≠nuo, com forte acelera√ß√£o a partir de 2010. Nos √∫ltimos anos, o volume ultrapassou 150 milh√µes de litros anuais, refletindo o aumento da demanda global por vinhos acess√≠veis, especialmente nos mercados emergentes. A diversifica√ß√£o de r√≥tulos, acordos comerciais e o crescimento do consumo per capita em regi√µes como Am√©rica Latina e √Åsia impulsionaram esse movimento.

Espumante:

Embora represente um volume menor comparado ao vinho de mesa, os espumantes mostram uma tend√™ncia gradualmente ascendente, com crescimento sustentado a partir de 2005. A crescente valoriza√ß√£o de espumantes em eventos, celebra√ß√µes e como substituto de bebidas alco√≥licas mais caras contribui para esse crescimento, principalmente em pa√≠ses europeus, Am√©rica do Norte e √Åsia.

Suco de Uva:

O suco apresenta volume praticamente insignificante no panorama global de importa√ß√µes, indicando que seu consumo ainda √© amplamente abastecido por produ√ß√£o local em muitos pa√≠ses ou que se d√° por meio de outras formas (como concentrados e blends que n√£o entram na mesma categoria de medi√ß√£o).

| Produto   | Tend√™ncia Geral         | Destaques                    |
| --------- | ----------------------- | ---------------------------- |
| Vinho     | Crescimento acelerado   | Alta ap√≥s 2010               |
| Espumante | Crescimento moderado    | Aumento constante desde 2005 |
| Suco      | Irrelevante globalmente | Volume pr√≥ximo de zero       |

## Como √© o cen√°rio de produ√ß√£o de vinhos, sucos e derivados no Brasil?
"""

# Agrupar os dados por produto e transpor os anos
df_producao_anos = prodVinho.set_index('produto').loc[:, '1970':'2023'].T
df_producao_anos.index = df_producao_anos.index.astype(int)

# Plotar a produ√ß√£o ao longo do tempo
plt.figure(figsize=(14, 7))
for produto in df_producao_anos.columns:
    plt.plot(df_producao_anos.index, df_producao_anos[produto], label=produto)

plt.title('Produ√ß√£o Nacional de Vinhos, Sucos e Derivados no Brasil (1970-2023)')
plt.xlabel('Ano')
plt.ylabel('Volume Produzido (litros)')
plt.legend(title='Produto')
plt.grid(True, linestyle='--', alpha=0.7)
plt.tight_layout()
plt.show()

"""Cen√°rio da Produ√ß√£o Nacional de Vinhos, Sucos e Derivados no Brasil
Vinho de Mesa

√â o produto com maior volume de produ√ß√£o no Brasil. Ao longo das d√©cadas, o vinho de mesa apresentou oscila√ß√µes significativas, mas manteve-se como o principal item da vitivinicultura nacional, com picos que ultrapassam os 300 milh√µes de litros por ano. Essa predomin√¢ncia se deve ao uso de uvas americanas e h√≠bridas, adaptadas ao clima brasileiro, e ao consumo popular em larga escala.

Suco de Uva

A partir dos anos 2000, o suco de uva ganhou destaque, apresentando uma tend√™ncia de crescimento cont√≠nuo e consolidado, especialmente a partir de 2010. Isso reflete o aumento do consumo de bebidas saud√°veis e integrais, impulsionado por campanhas de alimenta√ß√£o natural, pelo mercado escolar e por exporta√ß√µes. Em anos recentes, sua produ√ß√£o chegou a superar 100 milh√µes de litros.

Derivados da Uva

Incluem produtos como mosto concentrado, uva-passa e outros subprodutos. A partir de 2010, observou-se um crescimento acelerado, com volumes se aproximando do suco de uva, indicando maior aproveitamento da cadeia produtiva e valoriza√ß√£o de produtos alternativos ao vinho.

Vinho Fino de Mesa (Vin√≠fera)

Apesar de sua qualidade superior, esse segmento representa menor volume em compara√ß√£o aos demais, com produ√ß√£o est√°vel entre 30 e 50 milh√µes de litros por ano. Seu crescimento √© mais lento, pois depende de uvas vin√≠feras, exigentes em clima e manejo, geralmente cultivadas na Serra Ga√∫cha e em regi√µes espec√≠ficas como o Vale do S√£o Francisco.

| Produto               | Tend√™ncia                       | Destaques                 |
| --------------------- | ------------------------------- | ------------------------- |
| Vinho de Mesa         | Oscilante, mas dominante        | Popularidade e volume     |
| Suco de Uva           | Crescimento cont√≠nuo            | Sa√∫de e exporta√ß√µes       |
| Derivados             | Crescimento expressivo p√≥s-2010 | Valoriza√ß√£o da cadeia     |
| Vinho Fino (Vin√≠fera) | Est√°vel, em menor escala        | Qualidade e nicho premium |

E qual √© o valor de exporta√ß√£o dos produtos de vinhos de mesa, espumantes e sucos de uva para o ano mais recente da base?
"""

# Verificar o √∫ltimo ano dispon√≠vel nas colunas de valor da base de exporta√ß√£o
ultimo_ano = max([int(col) for col in df_exp.columns if col.isnumeric()])

# Filtrar apenas o √∫ltimo ano e produtos de interesse
produtos_exportados = ['Vinho', 'Espumante', 'Suco']
df_exp_ultimo_ano = df_exp[df_exp['Origem'].isin(produtos_exportados)]

# Agrupar por tipo de produto e somar o volume exportado no √∫ltimo ano
valor_exportado_ultimo_ano = df_exp_ultimo_ano.groupby('Origem')[str(ultimo_ano)].sum().sort_values(ascending=False)

valor_exportado_ultimo_ano.head()

# Identificar colunas de valor monet√°rio (sufixo .1) e pegar a do ano mais recente
coluna_valor_usd = f"{ultimo_ano}.1"

# Agrupar por tipo de produto e somar os valores em d√≥lares
valor_usd_exportado_ultimo_ano = df_exp_ultimo_ano.groupby('Origem')[coluna_valor_usd].sum().sort_values(ascending=False)

# Combinar os resultados de volume e valor em um DataFrame para exibi√ß√£o
df_resultado_2024 = pd.DataFrame({
    "Volume Exportado (Litros)": valor_exportado_ultimo_ano,
    "Valor Exportado (US$)": valor_usd_exportado_ultimo_ano
})

df_resultado_2024.head()

